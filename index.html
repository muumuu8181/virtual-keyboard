<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#4CAF50">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="VKeyboard">
    <style>
        :root {
            --app-version: "v0.53";  /* â˜…ã“ã“ã ã‘å¤‰æ›´ã™ã‚Œã°OKï¼ˆå…¨ä½“ã«è‡ªå‹•åæ˜ ï¼‰ */
            --scale: 1;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            transform: scale(var(--scale));
            transform-origin: top center;
        }
        
        .version-display {
            position: fixed;
            top: 2px;
            right: 5px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 10px;
            z-index: 1000;
        }

        .version-display::after {
            content: var(--app-version);
        }

        .zoom-controls {
            position: fixed;
            top: 2px;
            left: 5px;
            display: flex;
            gap: 5px;
            z-index: 1000;
        }

        .zoom-btn {
            background: rgba(0,0,0,0.7);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 14px;
            cursor: pointer;
            font-weight: bold;
        }

        .zoom-btn:hover {
            background: rgba(0,0,0,0.9);
        }

        .zoom-display {
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 3px;
            font-size: 12px;
        }
        
        .input-display {
            width: 250px;
            height: 40px;
            background: white;
            border: 2px solid #ccc;
            border-radius: 10px;
            padding: 10px;
            font-size: 20px;
            margin: 15px auto;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            overflow: hidden;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .keyboard {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 600px;
            width: 95%;
            justify-content: center;
            align-items: center;
        }
        
        .keyboard-panel {
            background: #f8f8f8;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            position: relative;
        }
        
        .panel-label {
            position: absolute;
            top: -10px;
            left: 15px;
            background: #333;
            color: white;
            padding: 2px 8px;
            border-radius: 3px;
            font-size: 12px;
            font-weight: bold;
        }
        
        .left-keyboard {
            display: flex;
            flex-direction: column;
            gap: 5px;
            width: 100%;
            max-width: 900px;
        }
        
        .right-numpad {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 5px;
            width: 100%;
            max-width: 320px;
            margin: 0 auto;
        }
        
        .numpad-key {
            background: linear-gradient(145deg, #ffffff, #e6e6e6);
            border: 2px solid #ccc;
            border-radius: 8px;
            padding: 12px;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            cursor: pointer;
            transition: all 0.1s ease;
            text-align: center;
            user-select: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            min-height: 35px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .numpad-key:hover {
            background: linear-gradient(145deg, #f0f0f0, #d0d0d0);
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0,0,0,0.15);
        }
        
        .numpad-zero {
            grid-column: span 2;
        }
        
        .keyboard-row {
            display: flex;
            justify-content: center;
            gap: 3px;
            flex-wrap: nowrap;
        }
        
        .key {
            background: linear-gradient(145deg, #ffffff, #e6e6e6);
            border: 2px solid #ccc;
            border-radius: 8px;
            padding: 1px 15px;
            font-size: 16px;
            font-weight: bold;
            color: #333;
            cursor: pointer;
            transition: all 0.1s ease;
            min-width: 40px;
            text-align: center;
            user-select: none;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            flex: 1;
        }
        
        .key:hover {
            background: linear-gradient(145deg, #f0f0f0, #d0d0d0);
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0,0,0,0.15);
        }
        
        .key:active {
            background: linear-gradient(145deg, #d0d0d0, #b0b0b0);
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        .space-key {
            flex-grow: 1;
            max-width: 300px;
        }
        
        .function-key {
            background: linear-gradient(145deg, #4CAF50, #45a049);
            color: white;
        }
        
        .function-key:hover {
            background: linear-gradient(145deg, #45a049, #3d8b40);
        }
        
        .clear-key {
            background: linear-gradient(145deg, #f44336, #d32f2f);
            color: white;
        }
        
        .clear-key:hover {
            background: linear-gradient(145deg, #d32f2f, #b71c1c);
        }
        
        .template-container {
            width: 90%;
            max-width: 800px;
            display: flex;
            gap: 10px;
            margin: 10px auto;
        }
        
        .template-display {
            flex: 1;
            background: #e8f5e8;
            border: 2px solid #4CAF50;
            border-radius: 10px;
            padding: 15px;
            font-size: 18px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            min-height: 30px;
            overflow-wrap: break-word;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        
        .template-display:hover {
            background: #d4f4d4;
        }

        .copy-status {
            background: #333;
            color: white;
            border-radius: 8px;
            padding: 8px 16px;
            font-size: 14px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            white-space: nowrap;
            flex-shrink: 0;
            min-width: 80px;
            text-align: center;
        }

        .template-lookup-key {
            background: linear-gradient(145deg, #9C27B0, #7B1FA2);
            color: white;
        }

        .template-lookup-key:hover {
            background: linear-gradient(145deg, #7B1FA2, #6A1B9A);
        }

        .register-key {
            background: linear-gradient(145deg, #FF5722, #E64A19);
            color: white;
        }

        .register-key:hover {
            background: linear-gradient(145deg, #E64A19, #D84315);
        }

        .register-area {
            width: 90%;
            max-width: 800px;
            margin: 15px auto;
            background: #fff3e0;
            border: 2px solid #FF5722;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            display: none;
        }

        .register-textarea {
            width: 100%;
            min-height: 320px;
            max-height: 800px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: 14px;
            resize: vertical;
            margin-bottom: 10px;
        }

        .register-controls {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .register-button {
            background: linear-gradient(145deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .register-button:hover {
            background: linear-gradient(145deg, #45a049, #3d8b40);
        }

        .cancel-button {
            background: linear-gradient(145deg, #757575, #616161);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .cancel-button:hover {
            background: linear-gradient(145deg, #616161, #424242);
        }
        
        .list-key {
            background: linear-gradient(145deg, #2196F3, #1976D2);
            color: white;
        }

        .list-key:hover {
            background: linear-gradient(145deg, #1976D2, #1565C0);
        }

        .memo-key {
            background: linear-gradient(145deg, #FF9800, #F57C00);
            color: white;
        }

        .memo-key:hover {
            background: linear-gradient(145deg, #F57C00, #E65100);
        }

        .memo-view-key {
            background: linear-gradient(145deg, #607D8B, #455A64);
            color: white;
        }

        .memo-view-key:hover {
            background: linear-gradient(145deg, #455A64, #37474F);
        }

        .template-list {
            width: 90%;
            max-width: 900px;
            margin: 15px auto;
            background: #f8f9fa;
            border: 2px solid #2196F3;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            display: none;
            max-height: 60vh;
            overflow-y: auto;
        }

        .category-section {
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 15px;
        }

        .category-title {
            font-weight: bold;
            font-size: 16px;
            color: #1976D2;
            margin-bottom: 10px;
            cursor: pointer;
            padding: 8px 12px;
            background: #e3f2fd;
            border-radius: 5px;
            border: 1px solid #2196F3;
            transition: all 0.2s ease;
            user-select: none;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .category-title:hover {
            background: #bbdefb;
        }
        
        .category-items {
            display: none;
            margin-left: 15px;
            border-left: 2px solid #e3f2fd;
            padding-left: 15px;
        }
        
        .category-items.expanded {
            display: block;
        }
        
        .expand-icon {
            font-size: 14px;
            transition: transform 0.2s ease;
        }
        
        .expand-icon.expanded {
            transform: rotate(90deg);
        }

        .template-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 15px;
            margin: 5px 0;
            background: white;
            border: 1px solid #eee;
            border-radius: 5px;
            font-size: 13px;
        }

        .template-code {
            font-weight: bold;
            color: #1976D2;
            min-width: 60px;
        }

        .template-text {
            flex: 1;
            margin-left: 10px;
            color: #555;
        }

        .template-actions {
            display: flex;
            gap: 5px;
        }

        .edit-btn, .delete-btn {
            background: none;
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 3px 8px;
            cursor: pointer;
            font-size: 11px;
        }

        .edit-btn {
            color: #4CAF50;
            border-color: #4CAF50;
        }

        .delete-btn {
            color: #f44336;
            border-color: #f44336;
        }

        .edit-btn:hover {
            background: #4CAF50;
            color: white;
        }

        .delete-btn:hover {
            background: #f44336;
            color: white;
        }

        .close-list-btn {
            float: right;
            background: #757575;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            margin-bottom: 15px;
        }

        .close-list-btn:hover {
            background: #616161;
        }

        .template-hint {
            font-size: 8px;
            color: #666;
            text-align: center;
            margin-bottom: 8px;
        }

        @media (max-width: 600px) {
            .key {
                padding: 10px 15px;
                font-size: 16px;
                min-width: 40px;
            }
        }
    </style>
</head>
<body>
    <div class="zoom-controls">
        <button class="zoom-btn" onclick="zoomOut()">ï¼</button>
        <div class="zoom-display" id="zoomDisplay">100%</div>
        <button class="zoom-btn" onclick="zoomIn()">ï¼‹</button>
    </div>
    <div class="version-display"></div>

    <div class="keyboard">
        <!-- ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆï¼‹æ•°å­—ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ -->
        <div class="keyboard-panel left-keyboard">
            <!-- æ•°å­—ã‚­ãƒ¼è¡Œ -->
            <div class="keyboard-row">
                <button class="key" data-key="1">1</button>
                <button class="key" data-key="2">2</button>
                <button class="key" data-key="3">3</button>
                <button class="key" data-key="4">4</button>
                <button class="key" data-key="5">5</button>
                <button class="key" data-key="6">6</button>
                <button class="key" data-key="7">7</button>
                <button class="key" data-key="8">8</button>
                <button class="key" data-key="9">9</button>
                <button class="key" data-key="0">0</button>
            </div>
            <!-- ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆè¡Œ1 -->
            <div class="keyboard-row">
                <button class="key" data-key="Q">Q</button>
                <button class="key" data-key="W">W</button>
                <button class="key" data-key="E">E</button>
                <button class="key" data-key="R">R</button>
                <button class="key" data-key="T">T</button>
                <button class="key" data-key="Y">Y</button>
                <button class="key" data-key="U">U</button>
                <button class="key" data-key="I">I</button>
                <button class="key" data-key="O">O</button>
                <button class="key" data-key="P">P</button>
            </div>
            
            <!-- ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆè¡Œ2 -->
            <div class="keyboard-row">
                <button class="key" data-key="A">A</button>
                <button class="key" data-key="S">S</button>
                <button class="key" data-key="D">D</button>
                <button class="key" data-key="F">F</button>
                <button class="key" data-key="G">G</button>
                <button class="key" data-key="H">H</button>
                <button class="key" data-key="J">J</button>
                <button class="key" data-key="K">K</button>
                <button class="key" data-key="L">L</button>
            </div>
            
            <!-- ã‚¢ãƒ«ãƒ•ã‚¡ãƒ™ãƒƒãƒˆè¡Œ3 -->
            <div class="keyboard-row">
                <button class="key" data-key="Z">Z</button>
                <button class="key" data-key="X">X</button>
                <button class="key" data-key="C">C</button>
                <button class="key" data-key="V">V</button>
                <button class="key" data-key="B">B</button>
                <button class="key" data-key="N">N</button>
                <button class="key" data-key="M">M</button>
            </div>
            
            <!-- æ©Ÿèƒ½ã‚­ãƒ¼è¡Œ -->
            <div class="keyboard-row">
                <button class="key function-key" data-action="backspace">ä¸€æ–‡å­—å‰Šé™¤</button>
                <button class="key clear-key" data-action="clear">ã‚¯ãƒªã‚¢</button>
                <button class="key template-lookup-key" data-action="lookup">æ¤œç´¢</button>
                <button class="key register-key" data-action="clipboard-read">ğŸ“ç™»éŒ²</button>
                <button class="key list-key" data-action="show-list">ğŸ“‹ä¸€è¦§</button>
                <button class="key memo-key" data-action="memo-add">ğŸ“„ãƒ¡ãƒ¢</button>
                <button class="key memo-view-key" data-action="memo-view">ğŸ‘ï¸ç¢ºèª</button>
            </div>
        </div>
    </div>
    
    <!-- å…¥åŠ›æ¬„ -->
    <div id="display" class="input-display"></div>
    
    <!-- ç™»éŒ²ã‚¨ãƒªã‚¢ï¼ˆå‹•çš„è¡¨ç¤ºï¼‰ -->
    <div id="registerArea" class="register-area">
        <h3>ğŸ“ æ–°ã—ã„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç™»éŒ²</h3>
        <textarea id="registerTextarea" class="register-textarea" placeholder="ã“ã“ã«ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ–‡ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."></textarea>
        <div class="register-controls">
            <input type="text" id="templateCode" placeholder="ã‚³ãƒ¼ãƒ‰ï¼ˆä¾‹: abc1ï¼‰" style="padding: 8px; border: 1px solid #ccc; border-radius: 5px; margin-right: 10px; flex-grow: 1;">
            <button class="cancel-button" onclick="hideRegisterArea()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            <button class="register-button" onclick="saveNewTemplate()">ğŸ“ç™»éŒ²</button>
        </div>
    </div>

    <!-- ãƒ¡ãƒ¢ã‚¨ãƒªã‚¢ï¼ˆå‹•çš„è¡¨ç¤ºï¼‰ -->
    <div id="memoArea" class="register-area" style="display: none;">
        <h3>ğŸ“„ æ–°ã—ã„ãƒ¡ãƒ¢ã‚’è¿½åŠ </h3>
        <textarea id="memoTextarea" class="register-textarea" placeholder="ã“ã“ã«ãƒ¡ãƒ¢ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."></textarea>
        <div class="register-controls">
            <button class="cancel-button" onclick="hideMemoArea()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
            <button class="register-button" onclick="saveMemo()">ğŸ“„ä¿å­˜</button>
        </div>
    </div>
    
    <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆè¡¨ç¤ºæ¬„ -->
    <div id="template-container" class="template-container" style="display: none;">
        <div id="template-display" class="template-display">
            <div id="template-content"></div>
        </div>
        <div id="copy-status" class="copy-status">ã‚³ãƒ”ãƒ¼</div>
    </div>
    
    <!-- ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§ï¼ˆå‹•çš„è¡¨ç¤ºï¼‰ -->
    <div id="templateList" class="template-list">
        <button class="close-list-btn" onclick="hideTemplateList()">âœ• é–‰ã˜ã‚‹</button>
        <h3>ğŸ“‹ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§</h3>
        <div id="listContent"></div>
    </div>

    <!-- ãƒ¡ãƒ¢ä¸€è¦§ï¼ˆå‹•çš„è¡¨ç¤ºï¼‰ -->
    <div id="memoList" class="template-list" style="display: none;">
        <button class="close-list-btn" onclick="hideMemoList()">âœ• é–‰ã˜ã‚‹</button>
        <h3>ğŸ“„ ãƒ¡ãƒ¢ä¸€è¦§</h3>
        <div id="memoListContent"></div>
    </div>

    <script>
        // Zoom functionality
        let currentZoom = 1.0;
        const zoomStep = 0.1;
        const minZoom = 0.5;
        const maxZoom = 2.0;

        function updateZoom() {
            document.documentElement.style.setProperty('--scale', currentZoom);
            document.getElementById('zoomDisplay').textContent = Math.round(currentZoom * 100) + '%';
            localStorage.setItem('appZoom', currentZoom);
        }

        function zoomIn() {
            if (currentZoom < maxZoom) {
                currentZoom += zoomStep;
                updateZoom();
            }
        }

        function zoomOut() {
            if (currentZoom > minZoom) {
                currentZoom -= zoomStep;
                updateZoom();
            }
        }

        // Load saved zoom level
        const savedZoom = localStorage.getItem('appZoom');
        if (savedZoom) {
            currentZoom = parseFloat(savedZoom);
            updateZoom();
        }

        // ãƒãƒ¼ã‚¸ãƒ§ãƒ³å–å¾—ï¼ˆCSSå¤‰æ•°ã‹ã‚‰ï¼‰
        const APP_VERSION = getComputedStyle(document.documentElement).getPropertyValue('--app-version').trim().replace(/['"]/g, '');

        // Service Worker Registration for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // ãƒãƒ¼ã‚¸ãƒ§ãƒ³æƒ…å ±ã‚’Service Workerã«æ¸¡ã™
                navigator.serviceWorker.register(`./sw.js?version=${APP_VERSION}`)
                    .then(registration => {
                        console.log('SW registered: ', registration);
                        console.log('App Version: ', APP_VERSION);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }

        let display = document.getElementById('display');
        let templateContainer = document.getElementById('template-container');
        let templateDisplay = document.getElementById('template-display');
        let templateContent = document.getElementById('template-content');
        let copyStatus = document.getElementById('copy-status');
        let registerArea = document.getElementById('registerArea');
        let registerTextarea = document.getElementById('registerTextarea');
        let templateCode = document.getElementById('templateCode');
        let templateList = document.getElementById('templateList');
        let listContent = document.getElementById('listContent');
        let memoArea = document.getElementById('memoArea');
        let memoTextarea = document.getElementById('memoTextarea');
        let memoList = document.getElementById('memoList');
        let memoListContent = document.getElementById('memoListContent');
        
        // ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰æ—¢å­˜ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’èª­ã¿è¾¼ã¿
        function loadCustomTemplates() {
            const saved = localStorage.getItem('customTemplates');
            return saved ? JSON.parse(saved) : {};
        }
        
        function saveCustomTemplates(customTemplates) {
            localStorage.setItem('customTemplates', JSON.stringify(customTemplates));
        }

        // ãƒ¡ãƒ¢æ©Ÿèƒ½
        function loadMemos() {
            const saved = localStorage.getItem('memos');
            return saved ? JSON.parse(saved) : [];
        }
        
        function saveMemos(memos) {
            localStorage.setItem('memos', JSON.stringify(memos));
        }
        
        // ã‚«ã‚¹ã‚¿ãƒ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
        let customTemplates = loadCustomTemplates();
        
        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆ + ã‚«ã‚¹ã‚¿ãƒ ï¼‰
        const defaultTemplates = {
            // REQç³»åˆ— - è¦ä»¶å®šç¾©
            'req1': 'å…±é€šè¦ä»¶å®šç¾©ï¼šãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ï¼ˆreq/sec, p95ï¼‰ã€‚å›½éš›åŒ–ã¨ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ã¯é››å½¢å¯¾å¿œï¼ˆi18nã®è¾æ›¸åˆ†é›¢ã€ãƒ•ã‚©ãƒ¼ãƒ ã«åŸºæœ¬ARIAï¼‰ã€‚ç¯„å›²ï¼ˆæ©Ÿèƒ½ï¼‰ï¼šèªè¨¼ã¯ãƒ€ãƒŸãƒ¼ã§ã‚‚è‰¯ã„ãŒæ‹¡å¼µç‚¹ã‚’è¨­ã‘ã‚‹ï¼ˆãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼ãƒ•ãƒƒã‚¯ã‚’æŠ½è±¡åŒ–ï¼‰ã€‚ä¸»è¦ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã‚’1ã€œ2æœ¬ã€CRUDã‚’1ç³»çµ±ï¼ˆä¾‹ï¼šItemï¼‰å®Ÿè£…ã€‚å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆã‚µãƒ¼ãƒå´å¿…é ˆã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå´ã¯ç°¡æ˜“ï¼‰ã€‚ã‚¨ãƒ©ãƒ¼è¨­è¨ˆï¼ˆã‚³ãƒ¼ãƒ‰ãƒ»ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ»å†ç¾æ‰‹é †ã‚’ãƒ­ã‚°ï¼‰ã€‚éæ©Ÿèƒ½ï¼ˆå“è³ªåŸºæº–ï¼‰ï¼šèµ·å‹•ï¼šmake dev ã‚‚ã—ãã¯ ./scripts/dev.sh ã®ãƒ¯ãƒ³ã‚³ãƒãƒ³ãƒ‰ã€‚ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®å®‰ï¼šå˜ä¸€ãƒãƒ¼ãƒ‰ã§æ¯ç§’50ãƒªã‚¯ã‚¨ã‚¹ãƒˆç¨‹åº¦ã®ãƒãƒƒãƒ”ãƒ¼ãƒ‘ã‚¹ã‚’é€šã™ç°¡æ˜“è² è·è©¦é¨“ã‚’ç”¨æ„ã€‚ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼šOWASP Top 10 ã‚’è¸ã¾ãˆã€å…¥åŠ›ã‚µãƒ‹ã‚¿ã‚¤ã‚ºãƒ»CSRF/SSRå¯¾ç­–ï¼ˆè©²å½“æ™‚ï¼‰ã‚’é››å½¢ã§å®Ÿè£…ã€‚å¯ç”¨æ€§ï¼šãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ /healthzã€‚å¯è¦³æ¸¬æ€§ï¼šæ§‹é€ åŒ–ãƒ­ã‚°ï¼ˆJSONï¼‰ã€æœ€ä½1ã¤ã®ãƒ“ã‚¸ãƒã‚¹ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚’è¨˜éŒ²ã€‚åŒæ¢±ï¼ˆç§˜å¯†å€¤ã¯ç©ºï¼‰ã€‚ä¾å­˜ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆDBãªã©ï¼‰ã®ãƒ­ãƒ¼ã‚«ãƒ«èµ·å‹•ç”¨ã«docker-compose.ymlã‚’ä»˜ä¸ï¼ˆä»»æ„ï¼‰ã€‚ãƒ­ã‚°ãƒ¬ãƒ™ãƒ«åˆ‡æ›¿ï¼ˆDEBUG/INFO/WARN/ERRORï¼‰ã€‚ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆè¦ä»¶ï¼ˆREADME æœ€ä½é …ç›®ï¼‰ï¼šãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦ï¼ˆ1æ®µè½ï¼‰ã€å…¨ä½“å›³ï¼ˆç°¡æ˜“ã‚¢ãƒ¼ã‚­å›³ï¼‰ã€è¦ä»¶ãƒ»å‰æã€ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã€ä¸»è¦ã‚³ãƒãƒ³ãƒ‰ã€APIä»•æ§˜ãƒªãƒ³ã‚¯ã€é–‹ç™ºè¦ç´„ã€æ—¢çŸ¥ã®åˆ¶é™ã€‚å—ã‘å…¥ã‚ŒåŸºæº–ï¼ˆå¿…ãšæº€ãŸã™ï¼‰ï¼šæ–°è¦ç’°å¢ƒã§10åˆ†ä»¥å†…ã«èµ·å‹•ã—ã€READMEã®æ‰‹é †ã§åŒã˜çµæœãŒå†ç¾ã§ãã‚‹ã€‚ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ä»•æ§˜ã¨å®Ÿè£…ãŒä¸€è‡´ï¼ˆè‡ªå‹•ãƒ†ã‚¹ãƒˆã§æ¤œè¨¼ï¼‰ã€‚ã‚¨ãƒ©ãƒ¼æ™‚ã«åŸå› è¿½è·¡ã«ååˆ†ãªæƒ…å ±ãŒãƒ­ã‚°ã«æ®‹ã‚‹ã€‚æœ€ä½1ã¤ã®"ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒä¾¡å€¤ã‚’æ„Ÿã˜ã‚‹ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹"ãŒãƒ–ãƒ©ã‚¦ã‚¶/CLI/APIã®ã„ãšã‚Œã‹ã‹ã‚‰å®Ÿè¡Œã§ãã‚‹ã€‚ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆå½¢å¼ï¼ˆã“ã®é †ã«æå‡ºï¼‰ï¼šã€Œè¨ˆç”»ã‚µãƒãƒªã€ï¼ˆ5ã€œ10è¡Œï¼‰ã€Œãƒªãƒã‚¸ãƒˆãƒªæ§‹æˆãƒ„ãƒªãƒ¼ã€ã€Œä¸»è¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾©ï¼ˆOpenAPI/Schemaï¼‰ã€ã€Œä¸»è¦ã‚³ãƒ¼ãƒ‰ã¨ãƒ†ã‚¹ãƒˆã€ã€Œèµ·å‹•æ‰‹é †ã¨ç¢ºèªæ‰‹é †ã€ã€Œä»Šå¾Œã®æ‹¡å¼µãƒã‚¤ãƒ³ãƒˆï¼ˆç®‡æ¡æ›¸ãã§3ã€œ5ç‚¹ï¼‰ã€ç¦æ­¢äº‹é …ï¼šç§˜å¯†æƒ…å ±ã®ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã€å†ç¾ä¸èƒ½ãªæ‰‹é †ã€READMEã¨å®Ÿæ…‹ã®ä¹–é›¢ã€‚',

            // REVç³»åˆ— - ãƒ¬ãƒ“ãƒ¥ãƒ¼
            'rev1': 'ä»Šå›ã¯è»½é‡ã®å¤šè§’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®Ÿæ–½ã—ã€2åã®ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§å®¢è¦³ãƒã‚§ãƒƒã‚¯ã‚’è¡Œã†ã€‚å½¹å‰²: QA-Agent â€” ä»•æ§˜æ•´åˆãƒ»ãƒ†ã‚¹ãƒˆãƒ»èµ·å‹•æ‰‹é †ã®å†ç¾æ€§ã‚’æ¤œè¨¼ã€‚å½¹å‰²: Sec-Agent â€” ä¾å­˜è„†å¼±æ€§ãƒ»ç§˜å¯†æƒ…å ±æ¼ãˆã„ãƒ»åŸºæœ¬ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ã‚’æ¤œè¨¼ã€‚é€šéæ¡ä»¶: Lint/Formatå…¨ç·‘ã€å˜ä½“ï¼‹çµåˆï¼ˆä¸»è¦1æœ¬ï¼‰é€šéã€OpenAPI/Schemaä¸€è‡´ã€‚é€šéæ¡ä»¶: ä¾å­˜è„†å¼±æ€§ High/Critical=0ã€ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆã®ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ 0ä»¶ã€‚é‹ç”¨ç¢ºèª: make devã§10åˆ†ä»¥å†…ã«èµ·å‹•ã€/healthzå¿œç­”ã€æ§‹é€ åŒ–ãƒ­ã‚°ï¼ˆä»»æ„ã§ç›¸é–¢IDï¼‰ã€‚ã‚¨ãƒ“ãƒ‡ãƒ³ã‚¹: /docs/reports/qa.md ã¨ /docs/reports/security.md ã‚’PRã«æ·»ä»˜ã€‚æ‰¿èª: PRã‚³ãƒ¡ãƒ³ãƒˆã§ "OK by @QA / @SEC" ã‚’æ˜è¨˜ã€‚å¤±æ•—æ™‚: å†ç¾æ‰‹é †ãƒ»æš«å®šå›é¿ãƒ»åŸå› ãƒ»ä¿®æ­£PRãƒªãƒ³ã‚¯ã‚’ incident-<id>.md ã«è¿½è¨˜ã€‚ä»Šå›é‡ç‚¹ãƒã‚§ãƒƒã‚¯ï¼šã€”ã“ã“ã«1è¡Œã§è¨˜è¼‰ï¼ˆä¾‹ï¼šèªè¨¼ã¾ã‚ã‚Šã®å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ˜ç¢ºåŒ–ï¼‰ã€•ã€‚é‡è¦ï¼šæŒ‡ç¤ºã‚’ã—ã¦ã„ãªã„ã®ã«å‹æ‰‹ã«æ–°ã—ã„ãƒ•ã‚©ãƒ«ãƒ€ã€ãƒ•ã‚¡ã‚¤ãƒ«ã€é–¢æ•°ã‚’è¿½åŠ ã—ã¦ã„ãªã„ã‹ã€‚ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆã‚’å£Šã—ã¦ã„ãªã„ã‹ã€‚rootã‚’æ±šã—ã¦ã„ãªã„ã‹',

            // CHKç³»åˆ— - å‹•ä½œç¢ºèª
            'chk1': 'ãƒªãƒ³ã‚¯å¥å…¨æ€§ï¼šREADME/ARCHITECTURE/runbook ã®ç›¸å¯¾ãƒªãƒ³ã‚¯ã¨ç”»åƒã¯ãƒªãƒ³ã‚¯åˆ‡ã‚Œ0ã€ã‚¢ãƒ³ã‚«ãƒ¼ã‚‚ä¸€è‡´ã€‚é‡è¤‡æƒ…å ±ã®ç¦æ­¢ï¼šä»•æ§˜ãƒ»è¨­å®šã¯å‡ºå…¸ã‚’1ã‹æ‰€ã«é›†ç´„ã—ã€ä»–ã¯å‚ç…§ãƒªãƒ³ã‚¯åŒ–ï¼ˆå¤šé‡è¨˜è¼‰ã‚’æ’é™¤ï¼‰ã€‚',
            // OTHç³»åˆ— - ãã®ä»–
            'oth1': 'ä½œæˆã—ãŸç‰©ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã„ã¦ã€‚',
            'oth2': 'ä»Šä¼ãˆãŸå†…å®¹ã‚’ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã¾ã¨ã‚ã¦ã€‚ãã®éš›ã«ãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ ã‚’æ„è­˜ã—ã¦ç ´å£Šã—ãªã„ã‚ˆã†ã«ã€‚readmeã«ã‚‚ãŸã©ã‚Œã‚‹ã‚ˆã†ã«è¨˜è¼‰ã—ã¦ã€‚',
            'oth3': 'æ—¢å­˜ã®æœ€å¤§ç•ªå·+1ã‹ã‚‰é †ã«è¿½åŠ ã€‚ã€(ã‚«ãƒ³ãƒ)ã§åŒºåˆ‡ã‚‰ã‚ŒãŸæŒ‡ç¤ºãŒ1ã¤ã®æ–‡ç« ã€‚ä»¥ä¸‹ã®æŒ‡ç¤ºã‚’othã‚«ãƒ†ã‚´ãƒªã«è¿½åŠ ã—ã¦ã€‚',
            'oth4': 'ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å¯¾ã—ã¦ã€æœ¬å½“ã«æ­£ã—ã„ã‹èª¿æŸ»æŒ‡ç¤ºã‚’å‡ºã—ã¦ã€‚ãã®éš›ã«ã§ãã‚‹ã ã‘ç´°ã‹ãè©³ç´°ã«ä¼ãˆã‚‹ã“ã¨ã€‚ãƒ‘ã‚¹ã¯ãƒ•ãƒ«ãƒ‘ã‚¹ã§ä¼ãˆã‚‹ã“ã¨ã€‚',
            'oth5': 'C:\\Users\\kakar\\Desktop\\work\\90_cc é…ä¸‹ã«ã€æœ¬æ—¥ã®æ—¥ä»˜ãƒ•ã‚©ãƒ«ãƒ€ã‚’ç”¨æ„ã—ã¦ã€‚æ—¢ã«å­˜åœ¨ã—ã¦ã„ãŸã‚‰ãã®ã¾ã¾ã§ã€‚æœ¬æ—¥ã®å–å¾—ã¯dateã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†ã“ã¨ã€‚ãã®ä¸­ã«bufãƒ•ã‚©ãƒ«ãƒ€ã‚’ç”¨æ„ã—ã¦ã€å›ã¯ãã®ä¸­ã ã‘ã§ä½œæ¥­ã‚’ã—ã¦ã€‚',
            'oth6': 'ä»¥ä¸‹ã®ãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­èº«ã‚’å…¨ã¦ç¢ºèªã—ã€å†…å®¹ã‚’è©³ç´°ã«æ•™ãˆã¦ã€‚ã¾ãŸã€ãƒ•ã‚©ãƒ«ãƒ€å…¨ä½“ã¨ã—ã¦æ”¹å–„ç‚¹ãŒã‚ã‚‹ã‹ã©ã†ã‹ã€ç¾åœ¨ã®ãƒ•ã‚©ãƒ«ãƒ€æ§‹æˆãªã‚Šã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå†…å®¹ã‚’å„é …ç›®10ç‚¹æº€ç‚¹ã§è©•ä¾¡ã—ã¦ã¿ã¦ã€‚å„é …ç›®ã¯å›ã®åˆ¤æ–­ã«ä»»ã›ã‚‹ã€‚ãƒ‘ã‚¹:',
            'oth7': 'æŒ‡å®šã—ãŸãƒ•ã‚©ãƒ«ãƒ€ã‚’å‡ºæ¥ã‚‹ã ã‘æ‹¡å¼µæ€§é«˜ãã€èª°ã«ã§ã‚‚ã‚ã‹ã‚‹å½¢ã§æ•´ç†ã€ç·¨é›†ã‚’ã—ã¦æ¬²ã—ã„ã€‚å¿…è¦ãªæƒ…å ±ã¯readmeã«ç¶²ç¾…çš„ã«è©°ã‚è¾¼ã¿ã€èª°ã‚‚ãŒãã“ã‚’è¦‹ãŸã‚‰ç†è§£ã§ãã‚‹æ§‹æˆã«ã™ã‚‹ã“ã¨ã€‚',
            'oth8': 'æ›¸ãæ›ãˆãªã„ã¨ã„ã‘ãªã„ç®‡æ‰€ã¯æœ€å°é™ã«ã—ã¦ã€‚ä¾‹ãˆã°ãƒãƒ¼ã‚¸ãƒ§ãƒ³å¤‰æ›´ã‚’ã™ã‚‹éš›ã«ã‚¢ãƒ—ãƒªã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ãã‚Œãã‚Œæœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã™ã‚‹ã‚ˆã†ãªä½œã‚Šã¯è…ã£ã¦ã‚‹ã€‚ä¸€ã‹æ‰€ã ã‘å¤‰æ›´ã—ãŸã‚‰çµ‚ã‚ã‚‹ã‚ˆã†ã«ã€‚ã‚¢ãƒ—ãƒªè¡¨è¨˜ã‚‚æœ€æ–°åŒ–ã•ã‚Œã¦ã„ã‚‹ã‚ˆã†ã«ã€‚',
            'oth42': 'ä»Šã®ä½œæ¥­çµæœãŒæœ¬å½“ã«å¦¥å½“ã‹ã©ã†ã‹ã€ç¬¬ä¸‰è€…èª¿æŸ»ã‚‚è¡Œã„ãŸã„ã€‚ã‚µãƒ–ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«å¯¾ã—ã¦ã€æœ¬å½“ã«æ­£ã—ã„ã‹èª¿æŸ»æŒ‡ç¤ºã‚’å‡ºã—ã¦ã€‚ãã®éš›ã«ã§ãã‚‹ã ã‘ç´°ã‹ãè©³ç´°ã«ä¼ãˆã‚‹ã“ã¨ã€‚ãƒ‘ã‚¹ã¯ãƒ•ãƒ«ãƒ‘ã‚¹ã§ä¼ãˆã‚‹ã“ã¨ã€‚'
        };
        
        // å…¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’çµåˆ
        function getAllTemplates() {
            return { ...defaultTemplates, ...customTemplates };
        }
        
        // ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½æ–°ï¼ˆæšå†…ã‚¯ãƒªãƒƒã‚¯ï¼‰
        templateDisplay.addEventListener('click', function() {
            const text = templateContent.textContent;
            navigator.clipboard.writeText(text).then(function() {
                copyStatus.textContent = 'ã‚³ãƒ”ãƒ¼å®Œäº†ï¼';
                setTimeout(() => {
                    copyStatus.textContent = 'ã‚³ãƒ”ãƒ¼';
                }, 1000);
            }).catch(function() {
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆå¤ã„ãƒ–ãƒ©ã‚¦ã‚¶ç”¨ï¼‰
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                copyStatus.textContent = 'ã‚³ãƒ”ãƒ¼å®Œäº†ï¼';
                setTimeout(() => {
                    copyStatus.textContent = 'ã‚³ãƒ”ãƒ¼';
                }, 1000);
            });
        });
        
        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ¤œç´¢æ©Ÿèƒ½
        function lookupTemplate(code) {
            const allTemplates = getAllTemplates();
            const template = allTemplates[code.toLowerCase()];
            if (template) {
                templateContent.textContent = template;
                templateContainer.style.display = 'flex';
                return true;
            }
            return false;
        }
        
        // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰èª­ã¿å–ã‚Šæ©Ÿèƒ½
        async function readClipboard() {
            try {
                const text = await navigator.clipboard.readText();
                registerTextarea.value = text;
                registerArea.style.display = 'block';
                registerTextarea.focus();
            } catch (err) {
                alert('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®èª­ã¿å–ã‚Šã«å¤±æ•—ã—ã¾ã—ãŸã€‚\næ‰‹å‹•ã§ãƒ†ã‚­ã‚¹ãƒˆã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„ã€‚');
                registerTextarea.value = '';
                registerArea.style.display = 'block';
                registerTextarea.focus();
            }
        }
        
        // ç™»éŒ²ã‚¨ãƒªã‚¢ã‚’éš ã™
        function hideRegisterArea() {
            registerArea.style.display = 'none';
            registerTextarea.value = '';
            templateCode.value = '';
        }

        // ãƒ¡ãƒ¢ã‚¨ãƒªã‚¢é–¢é€£
        function showMemoArea() {
            memoArea.style.display = 'block';
            memoTextarea.focus();
        }

        function hideMemoArea() {
            memoArea.style.display = 'none';
            memoTextarea.value = '';
        }

        function saveMemo() {
            const text = memoTextarea.value.trim();
            
            if (!text) {
                alert('ãƒ¡ãƒ¢å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                return;
            }

            const memos = loadMemos();
            const newMemo = {
                id: Date.now(),
                text: text,
                created: new Date().toLocaleString('ja-JP')
            };
            
            memos.unshift(newMemo); // æ–°ã—ã„ãƒ¡ãƒ¢ã‚’å…ˆé ­ã«è¿½åŠ 
            saveMemos(memos);
            
            hideMemoArea();
            alert('ãƒ¡ãƒ¢ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼');
        }
        
        // æ–°ã—ã„ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä¿å­˜
        function saveNewTemplate() {
            const code = templateCode.value.trim().toLowerCase();
            const text = registerTextarea.value.trim();
            
            if (!code || !text) {
                alert('ã‚³ãƒ¼ãƒ‰ã¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ–‡ã®ä¸¡æ–¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                return;
            }
            
            if (code.length < 3) {
                alert('ã‚³ãƒ¼ãƒ‰ã¯3æ–‡å­—ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
                return;
            }
            
            // æ—¢å­˜ãƒã‚§ãƒƒã‚¯
            const allTemplates = getAllTemplates();
            if (allTemplates[code]) {
                if (!confirm(`ã‚³ãƒ¼ãƒ‰ã€Œ${code}ã€ã¯æ—¢ã«å­˜åœ¨ã—ã¾ã™ã€‚ä¸Šæ›¸ãã—ã¾ã™ã‹ï¼Ÿ`)) {
                    return;
                }
            }
            
            // ä¿å­˜
            customTemplates[code] = text;
            saveCustomTemplates(customTemplates);
            
            // UIæ›´æ–°
            hideRegisterArea();
            alert(`ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€Œ${code}ã€ã‚’ç™»éŒ²ã—ã¾ã—ãŸï¼`);
            
            // ãƒ†ã‚¹ãƒˆç”¨ã«è‡ªå‹•æ¤œç´¢
            display.textContent = code;
            lookupTemplate(code);
        }
        
        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§ã‚’è¡¨ç¤º
        function showTemplateList() {
            console.log('ğŸš€ showTemplateListé–¢æ•°ãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸ');
            const allTemplates = getAllTemplates();
            console.log('ğŸ“š å…¨ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ:', allTemplates);
            const categories = {};
            
            // ã‚«ãƒ†ã‚´ãƒªãƒ¼åˆ¥ã«åˆ†é¡
            Object.keys(allTemplates).forEach(code => {
                const prefix = code.substring(0, 3).toUpperCase();
                if (!categories[prefix]) {
                    categories[prefix] = [];
                }
                categories[prefix].push({ code, text: allTemplates[code] });
            });
            
            let html = '';
            
            // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã®è¡¨ç¤º
            Object.keys(categories).sort().forEach(category => {
                const isCustom = categories[category].some(item => customTemplates[item.code]);
                const categoryName = getCategoryName(category);
                const count = categories[category].length;
                
                html += `<div class="category-section">`;
                html += `<div class="category-title" onclick="toggleCategory('${category}')">`;
                html += `<span>${category}ç³»åˆ— (${count}ä»¶) - ${categoryName}</span>`;
                html += `<span class="expand-icon" id="icon-${category}">â–¶</span>`;
                html += `</div>`;
                
                html += `<div class="category-items" id="items-${category}">`;
                categories[category].forEach(item => {
                    const isCustomTemplate = customTemplates[item.code];
                    html += `<div class="template-item" onclick="selectTemplateCode('${item.code}')" style="cursor: pointer;">`;
                    html += `<span class="template-code">${item.code}</span>`;
                    html += `<span class="template-text">${item.text}</span>`;
                    if (isCustomTemplate) {
                        html += `<div class="template-actions">`;
                        html += `<button class="edit-btn" onclick="editTemplate('${item.code}')">ç·¨é›†</button>`;
                        html += `<button class="delete-btn" onclick="deleteTemplate('${item.code}')">å‰Šé™¤</button>`;
                        html += `</div>`;
                    }
                    html += `</div>`;
                });
                html += `</div>`;
                
                html += `</div>`;
            });
            
            listContent.innerHTML = html;
            templateList.style.display = 'block';
        }
        
        // ã‚«ãƒ†ã‚´ãƒªãƒ¼åã‚’å–å¾—
        function getCategoryName(prefix) {
            const names = {
                'REQ': 'è¦ä»¶å®šç¾©',
                'REV': 'ãƒ¬ãƒ“ãƒ¥ãƒ¼',
                'CHK': 'å‹•ä½œç¢ºèª',
                'OTH': 'ãã®ä»–'
            };
            return names[prefix] || 'ã‚«ã‚¹ã‚¿ãƒ ';
        }
        
        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆä¸€è¦§ã‚’éš ã™
        function hideTemplateList() {
            templateList.style.display = 'none';
        }

        // ãƒ¡ãƒ¢ä¸€è¦§ã‚’è¡¨ç¤º
        function showMemoList() {
            const memos = loadMemos();
            
            if (memos.length === 0) {
                memoListContent.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">ã¾ã ãƒ¡ãƒ¢ãŒã‚ã‚Šã¾ã›ã‚“</p>';
            } else {
                let html = '';
                memos.forEach(memo => {
                    html += `<div class="template-item">`;
                    html += `<div style="flex: 1;">`;
                    html += `<div style="font-size: 12px; color: #666; margin-bottom: 5px;">${memo.created}</div>`;
                    html += `<div style="white-space: pre-wrap; word-break: break-word;">${memo.text}</div>`;
                    html += `</div>`;
                    html += `<div class="template-actions">`;
                    html += `<button class="delete-btn" onclick="deleteMemo(${memo.id})">å‰Šé™¤</button>`;
                    html += `</div>`;
                    html += `</div>`;
                });
                memoListContent.innerHTML = html;
            }
            
            memoList.style.display = 'block';
        }

        // ãƒ¡ãƒ¢ä¸€è¦§ã‚’éš ã™
        function hideMemoList() {
            memoList.style.display = 'none';
        }

        // ãƒ¡ãƒ¢ã‚’å‰Šé™¤
        function deleteMemo(memoId) {
            if (!confirm('ã“ã®ãƒ¡ãƒ¢ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ')) {
                return;
            }

            const memos = loadMemos();
            const filteredMemos = memos.filter(memo => memo.id !== memoId);
            saveMemos(filteredMemos);
            showMemoList(); // ä¸€è¦§ã‚’æ›´æ–°
            alert('ãƒ¡ãƒ¢ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚');
        }
        
        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ç·¨é›†
        function editTemplate(code) {
            const text = customTemplates[code];
            if (!text) return;
            
            registerTextarea.value = text;
            templateCode.value = code;
            registerArea.style.display = 'block';
            hideTemplateList();
            registerTextarea.focus();
        }
        
        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’å‰Šé™¤
        function deleteTemplate(code) {
            if (!customTemplates[code]) return;
            
            if (confirm(`ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€Œ${code}ã€ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ`)) {
                delete customTemplates[code];
                saveCustomTemplates(customTemplates);
                showTemplateList(); // ä¸€è¦§ã‚’æ›´æ–°
                alert(`ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€Œ${code}ã€ã‚’å‰Šé™¤ã—ã¾ã—ãŸã€‚`);
            }
        }
        
        // ã‚«ãƒ†ã‚´ãƒªãƒ¼ã®æŠ˜ã‚ŠãŸãŸã¿åˆ‡ã‚Šæ›¿ãˆ
        function toggleCategory(category) {
            const itemsElement = document.getElementById(`items-${category}`);
            const iconElement = document.getElementById(`icon-${category}`);
            
            if (itemsElement.classList.contains('expanded')) {
                itemsElement.classList.remove('expanded');
                iconElement.textContent = 'â–¶';
                iconElement.classList.remove('expanded');
            } else {
                itemsElement.classList.add('expanded');
                iconElement.textContent = 'â–¼';
                iconElement.classList.add('expanded');
            }
        }
        
        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ã‚¤ãƒ³ãƒ—ãƒƒãƒˆæ¬„ã«è¨­å®šã—ã€è‡ªå‹•æ¤œç´¢
        function selectTemplateCode(code) {
            display.textContent = code;
            console.log(`ğŸ“ ã‚³ãƒ¼ãƒ‰ã€Œ${code}ã€ã‚’ä¸€è¦§ã‹ã‚‰é¸æŠã—ã¾ã—ãŸ`);
            
            // ä¸€è¦§ã‚’é–‰ã˜ã‚‹
            console.log('ğŸ”„ ä¸€è¦§ã‚’é–‰ã˜ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™...');
            hideTemplateList();
            console.log('âœ… ä¸€è¦§ã‚’é–‰ã˜ã¾ã—ãŸ');
            
            // è‡ªå‹•ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ¤œç´¢ã‚’å®Ÿè¡Œ
            console.log(`ğŸ” ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€Œ${code}ã€ã‚’æ¤œç´¢ã—ã¾ã™...`);
            if (lookupTemplate(code)) {
                console.log(`âœ¨ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€Œ${code}ã€ã‚’è‡ªå‹•è¡¨ç¤ºã—ã¾ã—ãŸ`);
                // ã‚¤ãƒ³ãƒ—ãƒƒãƒˆæ¬„ã¯ã‚¯ãƒªã‚¢ã—ãªã„ï¼ˆæ‰‹å…¥åŠ›ã¨çµ±ä¸€ï¼‰
                console.log('ğŸ“Œ ã‚¤ãƒ³ãƒ—ãƒƒãƒˆæ¬„ã¯ãã®ã¾ã¾æ®‹ã—ã¾ã™ï¼ˆæ‰‹å…¥åŠ›ã¨çµ±ä¸€ï¼‰');
            } else {
                console.log(`âš ï¸ ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã€Œ${code}ã€ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“`);
            }
        }
        
        // ã‚­ãƒ¼ãƒœã‚¿ãƒ³ã«ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’è¿½åŠ ï¼ˆé€šå¸¸ã‚­ãƒ¼ã¨ãƒ†ãƒ³ã‚­ãƒ¼ä¸¡æ–¹ï¼‰
        document.querySelectorAll('.key, .numpad-key').forEach(key => {
            key.addEventListener('click', function() {
                const keyValue = this.getAttribute('data-key');
                const action = this.getAttribute('data-action');
                
                if (action === 'backspace') {
                    // å‰Šé™¤æ©Ÿèƒ½
                    display.textContent = display.textContent.slice(0, -1);
                } else if (action === 'clear') {
                    // ã‚¯ãƒªã‚¢æ©Ÿèƒ½
                    display.textContent = '';
                    templateContainer.style.display = 'none';
                } else if (action === 'clipboard-read') {
                    // ç™»éŒ²æ©Ÿèƒ½
                    readClipboard();
                } else if (action === 'show-list') {
                    // ä¸€è¦§è¡¨ç¤º
                    console.log('ğŸ“‹ ä¸€è¦§ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã¾ã—ãŸ');
                    showTemplateList();
                } else if (action === 'memo-add') {
                    // ãƒ¡ãƒ¢è¿½åŠ 
                    showMemoArea();
                } else if (action === 'memo-view') {
                    // ãƒ¡ãƒ¢ç¢ºèª
                    showMemoList();
                } else if (action === 'lookup') {
                    // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ¤œç´¢
                    const inputCode = display.textContent.trim();
                    
                    // ä¸€è¦§è¡¨ç¤ºãŒé–‹ã„ã¦ã„ã‚‹å ´åˆã¯é–‰ã˜ã‚‹
                    if (templateList.style.display === 'block') {
                        hideTemplateList();
                    }
                    
                    if (inputCode && lookupTemplate(inputCode)) {
                        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã£ãŸå ´åˆã¯å…¥åŠ›ã‚’ã‚¯ãƒªã‚¢
                        display.textContent = '';
                    } else {
                        // ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆ
                        alert('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ' + inputCode);
                    }
                } else if (keyValue) {
                    // æ–‡å­—å…¥åŠ›
                    display.textContent += keyValue;
                    
                    // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¤œç´¢ï¼ˆ3æ–‡å­—+æ•°å€¤ã®4æ–‡å­—ä»¥ä¸Šå…¥åŠ›æ™‚ï¼‰
                    const currentInput = display.textContent.trim();
                    if (currentInput.length >= 4) {
                        lookupTemplate(currentInput);
                    }
                }
                
                // ã‚­ãƒ¼ã‚’æŠ¼ã—ãŸæ™‚ã®ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åŠ¹æœ
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 100);
            });
        });
        
        // ç‰©ç†ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã®ã‚µãƒãƒ¼ãƒˆ
        document.addEventListener('keydown', function(event) {
            // é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ç”¨ã‚­ãƒ¼ã‚’é™¤å¤–
            if (event.key === 'F12' || (event.ctrlKey && event.shiftKey && event.key === 'I')) {
                return; // é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã‚’è¨±å¯
            }
            
            // ç™»éŒ²ã‚¨ãƒªã‚¢ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹å ´åˆã€ç‰©ç†ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚’ç„¡åŠ¹åŒ–
            if (registerArea.style.display === 'block') {
                // ç™»éŒ²ã‚¨ãƒªã‚¢å†…ã®è¦ç´ ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ãŒå½“ãŸã£ã¦ã„ã‚‹å ´åˆã¯é€šå¸¸ã®å…¥åŠ›ã‚’è¨±å¯
                if (event.target === registerTextarea || event.target === templateCode) {
                    return; // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‹•ä½œã‚’è¨±å¯
                }
                // ãã‚Œä»¥å¤–ã®å ´åˆã¯ç„¡åŠ¹åŒ–
                event.preventDefault();
                return;
            }
            
            event.preventDefault();
            const key = event.key.toUpperCase();
            
            if (key === 'BACKSPACE') {
                display.textContent = display.textContent.slice(0, -1);
            } else if (key === 'DELETE') {
                display.textContent = '';
                templateDisplay.style.display = 'none';
            } else if (key === 'ENTER') {
                // Enterã‚­ãƒ¼ã§ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæ¤œç´¢
                const inputCode = display.textContent.trim();
                if (inputCode && lookupTemplate(inputCode)) {
                    display.textContent = '';
                } else {
                    alert('ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: ' + inputCode);
                }
            } else if (key === ' ') {
                display.textContent += ' ';
            } else if ((key >= 'A' && key <= 'Z') || (key >= '0' && key <= '9')) {
                display.textContent += key;
                
                // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ¤œç´¢ï¼ˆ3æ–‡å­—+æ•°å€¤ã®4æ–‡å­—ä»¥ä¸Šå…¥åŠ›æ™‚ï¼‰
                const currentInput = display.textContent.trim();
                if (currentInput.length >= 4) {
                    lookupTemplate(currentInput);
                }
            }
        });
    </script>
</body>
</html>